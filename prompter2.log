2023-10-18 04:31:46,467 PUC Prompter: This is just an information for you
2023-10-18 04:31:46,508 Started server process [8168]
2023-10-18 04:31:46,509 Waiting for application startup.
2023-10-18 04:31:46,509 Application startup complete.
2023-10-18 04:31:46,509 Uvicorn running on http://0.0.0.0:5002 (Press CTRL+C to quit)
2023-10-18 04:32:33,587 Invalid HTTP request received.
2023-10-18 04:32:33,865 Invalid HTTP request received.
2023-10-18 04:32:34,127 Invalid HTTP request received.
2023-10-18 04:32:34,406 136.226.233.31:12409 - "GET / HTTP/1.1" 200
2023-10-18 04:32:34,414 Invalid HTTP request received.
2023-10-18 04:32:34,767 136.226.233.31:12409 - "GET /style.css HTTP/1.1" 200
2023-10-18 04:32:36,713 136.226.233.31:12409 - "GET /favicon.ico HTTP/1.1" 404
2023-10-18 04:32:45,725 Starting chain for query: आज तक कितने वाहन नियमों का पालन नहीं कर रहे हैं?
2023-10-18 04:32:46,606 hindi to english
2023-10-18 04:32:46,606 <Response [200]>
2023-10-18 04:32:46,606 {'id': '352a8606-4c8c-4704-859c-f12eec4486f7', 'model_id': 'tiiuae/falcon-40b', 'created_at': '2023-10-18T04:32:46.590Z', 'results': [{'generated_text': ' How many vehicles are there as of today that are non compliant?', 'generated_token_count': 13, 'input_token_count': 299, 'stop_reason': 'STOP_SEQUENCE', 'stop_sequence': '?', 'moderation': {'hap': []}}]}
2023-10-18 04:32:46,606 [{'generated_text': ' How many vehicles are there as of today that are non compliant?', 'generated_token_count': 13, 'input_token_count': 299, 'stop_reason': 'STOP_SEQUENCE', 'stop_sequence': '?', 'moderation': {'hap': []}}]
2023-10-18 04:32:46,606  How many vehicles are there as of today that are non compliant?
2023-10-18 04:32:46,607 Starting.........:  How many vehicles are there as of today that are non compliant?
2023-10-18 04:32:47,791 Attempting to connect to thingsboard.cxygprly1lns.us-east-1.rds.amazonaws.com
2023-10-18 04:32:47,846 Database connection successfull
2023-10-18 04:32:53,850 HTTP Request: POST https://bam-api.res.ibm.com/v1/generate "HTTP/1.1 200 OK"
2023-10-18 04:32:53,851 Output of GENAI call: SELECT count(DISTINCT d.id) FROM device d JOIN ts_kv_latest tsk ON d.id = tsk.entity_id JOIN ts_kv_dictionary tsm ON tsk.key = tsm.key_id WHERE ( tsm.key = 'CO_Idling' AND tsk.long_v > 0.3 ) OR ( tsm.key = 'HC' AND tsk.long_v > 200 ) OR ( tsm.key = 'CO_RPM' AND tsk.long_v > 0.2 )
2023-10-18 04:32:53,858 ========PROMPT============

Context: ```json
[{'count': 36}]
```
You are a pollution control assistant. Do not answer in code or json. You can use csv to represent arrays. 
Once you reply do not generate anything else. Give the answer in back ticks without any language type.
The answer should at least be one sentence long and not just numbers.
From the above context and no prior knowledge answer the question in plain english.
Question:  How many vehicles are there as of today that are non compliant?
Reply:
========================
2023-10-18 04:32:54,691 HTTP Request: POST https://bam-api.res.ibm.com/v1/generate "HTTP/1.1 200 OK"
2023-10-18 04:32:54,692 ==========LLM RESULT=======
 ```
There are 36 vehicles that are non compliant as of today.
```
===================
2023-10-18 04:32:54,692 Starting.........: 
There are 36 vehicles that are non compliant as of today.

2023-10-18 04:33:00,108 english to hindi
2023-10-18 04:33:00,108 [{'generated_text': ' आज तक 36 वाहन ऐसे हैं जो नियमों का अनुपालन नहीं कर रहे हैं।\n\nEnglish: \nThere are 36 vehicles that are non compliant as of today.', 'generated_token_count': 108, 'input_token_count': 211, 'stop_reason': 'STOP_SEQUENCE', 'stop_sequence': '.', 'moderation': {'hap': []}}]
2023-10-18 04:33:00,110 136.226.233.31:12410 - "GET /get?msg=%E0%A4%86%E0%A4%9C%20%E0%A4%A4%E0%A4%95%20%E0%A4%95%E0%A4%BF%E0%A4%A4%E0%A4%A8%E0%A5%87%20%E0%A4%B5%E0%A4%BE%E0%A4%B9%E0%A4%A8%20%E0%A4%A8%E0%A4%BF%E0%A4%AF%E0%A4%AE%E0%A5%8B%E0%A4%82%20%E0%A4%95%E0%A4%BE%20%E0%A4%AA%E0%A4%BE%E0%A4%B2%E0%A4%A8%20%E0%A4%A8%E0%A4%B9%E0%A5%80%E0%A4%82%20%E0%A4%95%E0%A4%B0%20%E0%A4%B0%E0%A4%B9%E0%A5%87%20%E0%A4%B9%E0%A5%88%E0%A4%82%3F HTTP/1.1" 200
2023-10-18 04:34:49,600 Starting chain for query: पुणे में कितने वाहन नियमों का पालन नहीं कर रहे हैं?
2023-10-18 04:34:50,547 hindi to english
2023-10-18 04:34:50,548 <Response [200]>
2023-10-18 04:34:50,548 {'id': 'c62d1c02-00c3-4d9d-90d3-935d7e45c2bc', 'model_id': 'tiiuae/falcon-40b', 'created_at': '2023-10-18T04:34:50.534Z', 'results': [{'generated_text': ' How many vehicles are there in Pune that are non compliant?', 'generated_token_count': 12, 'input_token_count': 305, 'stop_reason': 'STOP_SEQUENCE', 'stop_sequence': '?', 'moderation': {'hap': []}}]}
2023-10-18 04:34:50,548 [{'generated_text': ' How many vehicles are there in Pune that are non compliant?', 'generated_token_count': 12, 'input_token_count': 305, 'stop_reason': 'STOP_SEQUENCE', 'stop_sequence': '?', 'moderation': {'hap': []}}]
2023-10-18 04:34:50,548  How many vehicles are there in Pune that are non compliant?
2023-10-18 04:34:50,550 Starting.........:  How many vehicles are there in Pune that are non compliant?
2023-10-18 04:34:50,598 Attempting to connect to thingsboard.cxygprly1lns.us-east-1.rds.amazonaws.com
2023-10-18 04:34:50,659 Database connection successfull
2023-10-18 04:34:56,197 HTTP Request: POST https://bam-api.res.ibm.com/v1/generate "HTTP/1.1 200 OK"
2023-10-18 04:34:56,198 Extra fields missing from GenerateResult. Add Optional[Type] typing for these fields: {'stop_sequence'}
2023-10-18 04:34:56,198 Output of GENAI call: SELECT count(DISTINCT d.id) FROM device d JOIN ts_kv_latest tsk ON d.id = tsk.entity_id JOIN ts_kv_dictionary tsm ON tsk.key = tsm.key_id WHERE tsm.key = 'City' AND tsk.str_v = 'Pune' AND tsk.long_v > 0.3 OR tsm.key = 'HC' AND tsk.long_v > 200 OR tsm.key = 'CO_RPM' AND tsk.long_v > 0.2)
2023-10-18 04:34:56,200 Error executing query: syntax error at or near ")"
2023-10-18 04:34:56,200 Starting.........: I am unable to answer the question
2023-10-18 04:35:18,306 english to hindi
2023-10-18 04:35:18,306 [{'generated_text': ' मैं उन प्रश्न का जवाब देना अच्छा नहीं लिया हूँ।\n\nEnglish: I am unable to answer the question\nHindi: मैं उन प्रश्न का जवाब देना अच्छा नहीं लिया हूँ।\n\nEnglish: I am unable to answer the question\nHindi: मैं उन प्रश्न का जवाब देना अच्छा नहीं लिया हूँ।\n\nEnglish: I am unable to answer the question\nHindi: मैं उन प्रश्न का जवाब देना अच्छा नहीं लिया हूँ।\n\nEnglish: I am unable to answer the question\nHindi: मैं उन प्रश्न का जवाब देना अच्छा नहीं लिया हूँ।\n\nEnglish: I am unable to answer the question\nHindi: मैं उन प्रश्न का जवाब देना अच्छा नहीं लिया ', 'generated_token_count': 500, 'input_token_count': 202, 'stop_reason': 'MAX_TOKENS', 'moderation': {'hap': [{'flagged': True, 'score': 0.7638299465179443, 'success': True, 'position': {'start': 34, 'end': 82}}, {'flagged': True, 'score': 0.7681264281272888, 'success': True, 'position': {'start': 528, 'end': 577}}]}}]
2023-10-18 04:35:18,307 136.226.233.31:17726 - "GET /get?msg=%E0%A4%AA%E0%A5%81%E0%A4%A3%E0%A5%87%20%E0%A4%AE%E0%A5%87%E0%A4%82%20%E0%A4%95%E0%A4%BF%E0%A4%A4%E0%A4%A8%E0%A5%87%20%E0%A4%B5%E0%A4%BE%E0%A4%B9%E0%A4%A8%20%E0%A4%A8%E0%A4%BF%E0%A4%AF%E0%A4%AE%E0%A5%8B%E0%A4%82%20%E0%A4%95%E0%A4%BE%20%E0%A4%AA%E0%A4%BE%E0%A4%B2%E0%A4%A8%20%E0%A4%A8%E0%A4%B9%E0%A5%80%E0%A4%82%20%E0%A4%95%E0%A4%B0%20%E0%A4%B0%E0%A4%B9%E0%A5%87%20%E0%A4%B9%E0%A5%88%E0%A4%82%3F HTTP/1.1" 200
2023-10-18 04:35:54,357 Starting chain for query: How many non complaint vehicles in Pune city ? 
2023-10-18 04:35:55,421 hindi to english
2023-10-18 04:35:55,421 <Response [200]>
2023-10-18 04:35:55,422 {'id': '13e52efd-8a29-423e-8474-0d8907162f02', 'model_id': 'tiiuae/falcon-40b', 'created_at': '2023-10-18T04:35:55.410Z', 'results': [{'generated_text': ' How many non complaint vehicles in Pune city ?', 'generated_token_count': 10, 'input_token_count': 236, 'stop_reason': 'STOP_SEQUENCE', 'stop_sequence': '?', 'moderation': {'hap': []}}]}
2023-10-18 04:35:55,422 [{'generated_text': ' How many non complaint vehicles in Pune city ?', 'generated_token_count': 10, 'input_token_count': 236, 'stop_reason': 'STOP_SEQUENCE', 'stop_sequence': '?', 'moderation': {'hap': []}}]
2023-10-18 04:35:55,422  How many non complaint vehicles in Pune city ?
2023-10-18 04:35:55,423 Starting.........:  How many non complaint vehicles in Pune city ?
2023-10-18 04:35:55,456 Attempting to connect to thingsboard.cxygprly1lns.us-east-1.rds.amazonaws.com
2023-10-18 04:35:55,527 Database connection successfull
2023-10-18 04:36:00,543 HTTP Request: POST https://bam-api.res.ibm.com/v1/generate "HTTP/1.1 200 OK"
2023-10-18 04:36:00,544 Output of GENAI call: SQLResult: SELECT count(DISTINCT d.id) FROM device d JOIN ts_kv_latest tsk ON d.id = tsk.entity_id JOIN ts_kv_dictionary tsm ON tsk.key = tsm.key_id WHERE tsm.key = 'City' AND tsk.str_v = 'Pune'
2023-10-18 04:36:00,550 ========PROMPT============

Context: ```json
[{'count': 33}]
```
You are a pollution control assistant. Do not answer in code or json. You can use csv to represent arrays. 
Once you reply do not generate anything else. Give the answer in back ticks without any language type.
The answer should at least be one sentence long and not just numbers.
From the above context and no prior knowledge answer the question in plain english.
Question:  How many non complaint vehicles in Pune city ?
Reply:
========================
2023-10-18 04:36:01,088 HTTP Request: POST https://bam-api.res.ibm.com/v1/generate "HTTP/1.1 200 OK"
2023-10-18 04:36:01,089 ==========LLM RESULT=======
 ```
33
```

===================
2023-10-18 04:36:01,089 Starting.........: 
33

2023-10-18 04:36:28,217 english to hindi
2023-10-18 04:36:28,217 [{'generated_text': ' 33\n\nEnglish: \n34\n\nHindi: 34\n\nEnglish: \n35\n\nHindi: 35\n\nEnglish: \n36\n\nHindi: 36\n\nEnglish: \n37\n\nHindi: 37\n\nEnglish: \n38\n\nHindi: 38\n\nEnglish: \n39\n\nHindi: 39\n\nEnglish: \n40\n\nHindi: 40\n\nEnglish: \n41\n\nHindi: 41\n\nEnglish: \n42\n\nHindi: 42\n\nEnglish: \n43\n\nHindi: 43\n\nEnglish: \n44\n\nHindi: 44\n\nEnglish: \n45\n\nHindi: 45\n\nEnglish: \n46\n\nHindi: 46\n\nEnglish: \n47\n\nHindi: 47\n\nEnglish: \n48\n\nHindi: 48\n\nEnglish: \n49\n\nHindi: 49\n\nEnglish: \n50\n\nHindi: 50\n\nEnglish: \n51\n\nHindi: 51\n\nEnglish: \n52\n\nHindi: 52\n\nEnglish: \n53\n\nHindi: 53\n\nEnglish: \n54\n\nHindi: 54\n\nEnglish: \n55\n\nHindi: 55\n\nEnglish: \n56\n\nHindi: 56\n\nEnglish: \n57\n\nHindi: 57\n\nEnglish: \n58\n\nHindi: 58\n\nEnglish: \n59\n\nHindi: 59\n\nEnglish: \n60\n\nHindi: 60\n\nEnglish: \n61\n\nHindi: 61\n\nEnglish: \n62\n\nHindi: 62\n\nEnglish: \n63\n\nHindi: 63\n\nEnglish: \n64\n\nHindi: 64\n\nEnglish: \n65\n\nHindi: 65\n\nEnglish: \n66\n\nHindi: 66\n\nEnglish: \n67\n\nHindi: 67\n\nEnglish: \n68\n\nHindi: 68\n\nEnglish: \n69\n', 'generated_token_count': 500, 'input_token_count': 199, 'stop_reason': 'MAX_TOKENS', 'moderation': {'hap': []}}]
2023-10-18 04:36:28,220 136.226.233.31:18170 - "GET /get?msg=How%20many%20non%20complaint%20vehicles%20in%20Pune%20city%20%3F%20 HTTP/1.1" 200
2023-10-18 04:43:51,900 Shutting down
2023-10-18 04:43:52,011 Waiting for application shutdown.
2023-10-18 04:43:52,011 Application shutdown complete.
2023-10-18 04:43:52,012 Finished server process [8168]
